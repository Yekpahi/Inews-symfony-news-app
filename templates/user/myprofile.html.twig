{% block myprofile %}

	<section class="user-page section-padding">
		<div class="container">
			<div class="row align-items-stretch">
				<div class="col-lg-4 col-md-5 col-xs-12">
					<div class="user-profile-box">
						<div class="header clearfix d-flex flex-column align-items-center">
							<h2>{{app.user.firstName}}
								{{app.user.lastName}}</h2>

							{% if app.user.avatar %}
								<img id="g-profile-img" class="img-fuid mb-3" alt="photo de {{ app.user.firstName }} {{ app.user.firstName }}" src="{{asset(('uploads/images/avatar/' ~ app.user.avatar)|imagine_filter('avatar')) }}">

							{% else %}
								<img id="g-profile-img" class="img-fuid mb-3" width="80" height="80" alt="avatar" src="{{ asset('uploads/images/avatars/avatar.jpg')}}">
							{% endif %}
						</div>
						<div class="mt-1 d-flex justify-content-center">
							<button class="btn btn-primary btn-sm mt-3">
								{% if app.user.roles[0] == "ROLE_USER" %}
									Visiteur
								{% elseif app.user.roles[0] == "ROLE_REDACTOR" %}
									Rédacteur
								{% elseif app.user.roles[0] == "ROLE_ADMIN" %}
									Administrateur
								{% elseif app.user.roles[0] == "ROLE_CONTRIBUTOR" %}
									Contributeur
								{% endif %}
							</button>
						</div>
						<div class="detail clearfix">
							<ul class="list-group list-group-flush">
								<a href="" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
									Projets à valider
									<span class="badge badge-light badge-pill">14</span>
								</a>
								<a href="" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
									<strong>Tous les projets</strong>
									<span class="badge badge-light badge-pill">14</span>
								</a>
								<a href="" class="active list-group-item list-group-item-action d-flex justify-content-between align-items-center">
									<strong>Tous les financements</strong>
									<span class="badge badge-light badge-pill">14</span>
								</a>
							</div>
							<!-- Détail-->
						</div>
						<!-- User profile box-->
					</div>
					<div class="col-lg-8 col-md-7 col-xs-12">
						<div class="dashborad-box">
							<h4 class="title">Les informations sur
								{{app.user.firstName}}
								{{app.user.lastName}}
							</h4>
							<div class="section-body">
								<section class="about mb-3">
									<div class="card mx-auto">
										<div class="card-header">
											<i class="fas fa-user mr-3"></i>
											<span>{{app.user.firstName}}
												{{app.user.lastName}}</span>
										</div>
										<div class="card-body">
											<ul class="list-group list-group-flush" data-target="personal-info">
												<li class="list-group-item">
													<i class="fas fa-envelope fa-fw"></i>
													<span>{{app.user.email}}</span>
												</li>

												<li class="list-group-item">
													<i class="fas fa-mobile-alt fa-fw"></i>
													{% if app.user.sex == 0%}
														<span>
															Sexe : Homme</span>
													{% else %}
														<span>Sexe : Femme</span>
													{% endif %}
												</li>

												<li class="list-group-item">
													<i class="fas fa-map-marker-alt fa-fw"></i>
													<span>1064 glendale st</span>
												</li>

												<li class="list-group-item">
													<i class="fas fa-birthday-cake fa-fw"></i>
													<span>1973/06/04</span>
												</li>

											</ul>
											{% if app.user %}

												{% else %}
													<a href="" type="button" class="btn btn-primary" data-toggle="button" aria-pressed="false" autocomplete="off">
														Tous va bien
													</a>
											{% endif %}

										</div>
									</div>
								</section>
								<!-- /about -->
								<!-- row -->
							</div>
							<!-- sbody -->
						</div>
						<a href="{{ path ('user_articles_ajout')}}" type="button" class="btn btn-primary mb-5">Créer un
																										article</a>
						<button type="button" class="btn btn-outline-secondary mb-5 ">Galerie Photo</button>
						<button type="button" class="btn btn-outline-success mb-5">Galerie Vidéo</button>

						<!-- Modal -->
						<div id="input-modal">
							<input id="open" placeholder="Redigez un article" type="text">
						</div>


						<div id="mask" class="hidden"></div>
						<section id="modal" class="hidden">

							<div class="labelo-close">
								<h5>Créer Votre article</h5>
								<button id="close" style="font-size:24px">
									<i class="fa fa-close fermer"></i>
								</button>
							</div>

							{{ form_start(form, {'attr': {'class': 'articlecomplete'}}) }}

							{{ form_widget(form.title, {'attr' : {'type' : 'text', 'class' : 'title-article', "placeholder" : "Titre de l'article",'data-rule-required':'true' }}) }}
							{{ form_widget(form.description, {'attr' : {'type' : 'text', 'class' : 'description-article', "placeholder" : "Sous-titre de l'article",'data-rule-required':'true' }}) }}
							{{ form_widget(form.content, {'attr' : {'type' : 'textarea', 'row': '4', 'style' : "height:auto", 'id' : 'article', 'class' : 'content-article', 'placeholder' : "Redigez votre article",'data-rule-required':'true'}}) }}

							<div class="cat-statut">
								{{ form_widget(form.categories, {'attr' : {'type' : 'dropdown', 'row': '4', 'style' : "height:auto", 'id' : 'redact', 'class' : 'round', 'placeholder' : "Redigez votre article",'data-rule-required':'true'}}) }}
								{{ form_widget(form.statut, {'attr' : {'type' : 'dropdown', 'row': '4', 'style' : "height:auto", 'id' : 'redact', 'class' : 'round'}}) }}

							</div>
							<div class="browse">
								<div class="image-input">
									<input type="file" accept="image/*" id="imageInput">
									<label for="imageInput" class="image-button">
										<i class="far fa-image"></i>
										Choose image</label>
									<img src="" class="image-preview">
									<span class="change-image">Choose different image</span>
								</div>


								{{ form_widget(form.images, {'attr': {'type' : 'file', 'class' : 'browse-file', 'id' : 'imageInput'}}) }}


								{{ form_widget(form.active, {'attr' : {'type' : 'checkbox', 'name': 'scales', 'style' : "height:auto", 'id' : 'scales'}}) }}

							</div>

							<!--Fin charger fichier-->
							{{ form_widget(form.Valider, {'attr' : {'type' : 'submit', 'row': '4', 'style' : "height:auto", 'id' : 'article', 'class' : 'button-poster-article'}}) }}


							{{ form_end(form) }}

						</section>
						<!-- dashbox -->
						<div class="dashborad-box">
							<h4 class="title">Tableau</h4>
							<div class="section-body">

								<div class="table-responsive">
									<table class="table table-striped">
										<thead>
											<th>Titre de l'article</th>
											<th>Statut</th>
											<th>catégorie</th>
											<th>Date création</th>
											<th>Action</th>
											<th>Etat</th>
											<th>Images</th>
										</thead>
										{% for article in app.user.articles %}
											<tbody>
												<tr>
													<td>
														{{ article.title}}</td>
													<td>

														{% if article.active %}
															<span class="badge badge-pill badge-success">Activé</span>

														{% else %}
															<span class="badge badge-pill badge-danger">Desactivé</span>
														{% endif %}


													</td>
													<td>
														<span class="g-auteur">
															{{ article.categories.name}}</span>
														<br/>

													</td>
													<td>{{article.createdAt|date}}</td>
													<td>
														<a href="{{path('users_articles_delete',{id:article.id})}}">
															<span class="g-action fa fa-trash"></span>
														</a>
														<a href="{{path('users_articles_edit',{id:article.id})}}">
															<i class="fas fa-edit"></i>
														</a>

													</td>
													<td>
														{{ article.statut }}
													</td>

												</tr>
											</tbody>
										{% endfor %}
									</table>
								</div>
							</div>
						</h4>
					</div>

					<!-- Dbox -->
				</div>
			</div>
		</div>
	</section>
{% endblock %}
{% block javascripts %}
	<script>
		$('#imageInput').on('change', function () {
$input = $(this);
if ($input.val().length > 0) {
fileReader = new FileReader();
fileReader.onload = function (data) {
$('.image-preview').attr('src', data.target.result);
}
fileReader.readAsDataURL($input.prop('files')[0]);
$('.image-button').css('display', 'none');
$('.image-preview').css('display', 'block');
$('.change-image').css('display', 'block');
}
});

$('.change-image').on('click', function () {
$control = $(this);
$('#imageInput').val('');
$preview = $('.image-preview');
$preview.attr('src', '');
$preview.css('display', 'none');
$control.css('display', 'none');
$('.image-button').css('display', 'block');
});
	</script>

{% endblock %}
